## Cloud Native Days 2019

### 概要
#### スピーカー
市川豊さん / エーピーコミュニケーションズ

### Market Trend of Cloud Native
+ CKAというコンテナ関連の資格がある
+ CNCF -> KubernetesはCNCFのGraduateクラス（成熟したプロダクト）
+ 2018.6.7 EKSがGenerarlly Available
+ 2018.6.13 AKSリリース
+ 2019.4.10 Anthos公開（Google） -> k8sベースのハイブリッドプラットフォーム

### Dockerの正体
#### 従来の仮想化技術

**ホストOS型**  
- ホストOS上の仮想化アプリケーション上で仮想マシンを稼働させる

**ハイパーバイザ型**
- 物理ハードウェアにハイパーバイザー上で仮想マシンを稼働（ホストOSを必要としない）
- VMware ESXiなど

**ハイパーバイザ型（KVM）**
- Linuxのカーネルモジュール上のハイパーバイザ機能を利用

#### Linuxコンテナ
そもそも、仮想マシンやゲストOSという考え方がない（≠仮想）  
-> コンテナとは、**Linuxカーネルの機能でプロセスをグループに分割した、ユーザー空間のこと**  
-> OS側の脆弱性が実行環境にたいして影響を与えてしまう

+ namespace機能  
ユーザープロセスの分割、ファイルシステム、ネットワーク設定の分離などを行う

+ cgroups機能  
それぞれのコンテナに対してCPUやメモリ割り当てを行う

#### つまりDockerとは
>Linuxカーネルの機能を統合し、コンテナを作成してアプリケーションを稼働させるためのソフトウェア(インターフェーズのような存在)  
たとえば、シェルコマンドがカーネルに対する命令となるように、窓口のようなツール  
→ コンテナエンジンが分割されたNamespaceに対して操作を行う

### Docker基礎技術
+ DockerHub - イメージリポジトリ。レジストリ自体を自分で構築することも可能（harborなど）

+ Dockerイメージ - ReadOnlyで、レイヤード。起動すると書き込み可能なレイヤーが作られる  
→ イメージ層はコマンドごとに記録（ベースイメージはOSなど）  
→ レイヤー層を記録してバージョン管理を行う  
→ レイヤーが分厚くなると起動が重くなるので、どのように軽くしていくか考えることが必要（昨今研究が進んでいる）

#### Dockerfile
>イメージ構成をまとめて記述するテキスト形式ファイル。  
一行につき1つの操作を命令と引数でスペース区切りで記述し、上から順番に処理が実行される。

**基本的な流れ**

1. Dockerイメージ作成
2. イメージの保存・公開
3. サーバーにイメージ配布・実行

**メリット**
>OSのイメージまで定義された状態になっているので、いわゆるIT環境で動いていたのにSTG環境で動かないといった環境差異に起因する問題が起きずらい 。
また一連の流れをCI/CD化しやすい（ビルド・シップ・ラン）。
